{"version":3,"file":"7385.shopwp-components.js","mappings":"qiBAoCA,EAjCA,YAKG,IAJFA,EAIE,EAJFA,QACAC,EAGE,EAHFA,SAGE,IAFFC,OAAAA,OAEE,aADFC,SAAAA,OACE,SACIC,EAAqB,EAe3B,OACC,kBACCJ,QAASA,EACTK,SAAUH,EACVI,IAAG,CAAGF,EAAoBD,EAAvB,4BACFD,EACED,EAASM,4BACTN,EAASO,0B,gDCpBTC,EAA+BC,EAAWC,MAAK,kBACnD,kCAKIC,EAAoCF,EAAWC,MAAK,kBACxD,kC,qGAkIF,EA7HA,YAAyC,IAAZV,EAAY,EAAZA,SACnBY,GAAwBH,GAAGI,QAAnC,EAAQD,UAAUE,EAAlB,EAAkBA,UAClB,EAA4CF,GAAS,GAArD,eAAOG,EAAP,KAAuBC,EAAvB,KACA,EAAsCJ,GAAS,GAA/C,eAAOK,EAAP,KAAoBC,EAApB,KACA,EAA0BN,GAAS,GAAnC,eAAOO,EAAP,KAAcC,EAAd,KACA,EAAsDR,EAAS,IAA/D,eAAOS,EAAP,KAA4BC,EAA5B,KACA,EAAgCV,EAAS,IAAzC,eAAOW,EAAP,KAAiBC,EAAjB,KACA,EAAgDZ,EAAS,IAAzD,eAAOa,EAAP,KAAyBC,EAAzB,KACMC,GAAaC,EAAAA,EAAAA,IAAiB5B,EAAU,eACxC6B,GAAYC,EAAAA,EAAAA,KAElB,SAASC,EAAuBC,GAC9B,OAAOA,EAAKC,MAAMC,KAAI,SAACC,GACrB,MAAO,CAAEC,MAAOD,EAAWE,KAAKC,MAAOC,GAAIJ,EAAWE,KAAKE,OAbxB,SAiBxBC,IAjBwB,uEAiBvC,qHAA+BC,EAA/B,gCACEzB,GAAkB,GAEd0B,EAAS,CACXC,MAAO,IACPC,QAAS,QACTC,MAAOpC,EAASqC,aACd,gCACAC,EAAOC,QAAQC,UAEjBC,SAAS,GAGPT,IACFC,EAAM,OAAaD,GAdvB,UAiB4BU,EAAAA,EAAAA,IAAGC,EAAAA,EAAAA,IAAiBV,EAAQb,IAjBxD,kCAiBSwB,EAjBT,KAiBcrB,EAjBd,KAmBEhB,GAAkB,KAEdsC,GAAeC,EAAAA,EAAAA,IAAoBF,EAAKrB,GAAM,IArBpD,wBAwBIZ,EAASkC,GAxBb,2BA4BMtB,IACFR,EAAYQ,EAAKC,OAEbD,EAAKwB,SAASvC,YAChBC,GAAe,GAEfA,GAAe,GAGXuC,EAAmBhD,EAASqC,aAChC,kCACAY,GAAAA,CAAMrC,EAAoBsC,OAAO5B,EAAuBC,MAG1DN,EAAoB+B,GACpBnC,EAAuBmC,IA3C3B,4CAjBuC,wBAgEvC,SAASG,EAAOC,GACTA,IAIDxC,EAAoByC,OACtBpC,EAAoBL,GAItBmB,KA1EqC,wCA6EvC,qFACMuB,EAAWxC,EAASA,EAASuC,OAAS,KAE1BE,GAAAA,CAAID,EAAU,WAC5BvB,EAAgBuB,EAAStB,QAJ7B,4CA7EuC,sBAqFvC3B,GAAU,WACR8C,GAAO,KACN,IAEH,IAAMK,EAAc,EAKpB,OACE,QAACzD,EAAD,CACEW,MAAOA,EACPyC,OAAQA,EACRM,WAAYvC,EACZZ,eAAgBA,EAChBoD,UAAU,cACVC,sBAAuBC,GAAAA,CAAQ5C,GAC/B6C,uBAAwBtE,EAASsE,uBACjCC,QAASvE,EAASwE,mBAClBC,OACE,yBACE,QAAC9D,EAAD,CACE+D,cAAejD,EACfxB,OAAQc,EACR4D,SAAS,gBAEV1D,IACC,QAAC,EAAD,CACEjB,SAAUA,EACVC,OAAQc,EACRhB,QAnH2B,2CAoH3BG,SAAU+D","sources":["webpack://shopwpComponents/./src/common/buttons/secondary.jsx","webpack://shopwpComponents/./src/components/storefront/options/option-collections/index.jsx"],"sourcesContent":["/** @jsx jsx */\nimport { jsx, css } from '@emotion/react'\n\nfunction ButtonSecondary({\n\tonClick,\n\tsettings,\n\tisBusy = false,\n\textraCSS = false,\n}) {\n\tconst secondaryButtonCSS = css`\n\t\ttext-transform: capitalize;\n\t\tpadding: 5px 9px;\n\t\tbackground: white;\n\t\tfont-size: 14px;\n\t\tborder: 1px solid silver;\n\t\tappearance: none;\n\t\tfont-family: inherit;\n\n\t\t&:hover {\n\t\t\tcursor: pointer;\n\t\t\topacity: 0.8;\n\t\t}\n\t`\n\n\treturn (\n\t\t<button\n\t\t\tonClick={onClick}\n\t\t\tdisabled={isBusy}\n\t\t\tcss={[secondaryButtonCSS, extraCSS]}>\n\t\t\t{isBusy\n\t\t\t\t? settings.loadMoreCollectionsBusyText\n\t\t\t\t: settings.loadMoreCollectionsText}\n\t\t</button>\n\t)\n}\n\nexport default ButtonSecondary\n","/** @jsx jsx */\nimport { jsx, css } from \"@emotion/react\"\nimport isEmpty from \"lodash/isEmpty\"\nimport union from \"lodash/union\"\nimport has from \"lodash/has\"\nimport to from \"await-to-js\"\nimport { fetchCollections, maybeHandleApiError } from \"Api\"\nimport { shouldOpenOnLoad } from \"Utils\"\nimport ButtonSecondary from \"Common/buttons/secondary\"\nimport { useShopState } from \"../../../shop/_state/hooks\"\n\nconst StorefrontFilterOptionsGroup = wp.element.lazy(() =>\n  import(\n    /* webpackChunkName: 'StorefrontFilterOptionsGroup-public' */ \"../group\"\n  )\n)\n\nconst StorefrontFilterOptionsGroupItems = wp.element.lazy(() =>\n  import(\n    /* webpackChunkName: 'StorefrontFilterOptionsGroupItems-public' */ \"../group-items\"\n  )\n)\n\nfunction OptionCollections({ settings }) {\n  const { useState, useEffect } = wp.element\n  const [isLoadingItems, setIsLoadingItems] = useState(true)\n  const [hasNextPage, setHasNextPage] = useState(false)\n  const [error, setError] = useState(false)\n  const [existingCollections, setExistingCollections] = useState([])\n  const [itemsRaw, setItemsRaw] = useState([])\n  const [filterableValues, setFilterableValues] = useState([])\n  const shouldOpen = shouldOpenOnLoad(settings, \"collections\")\n  const shopState = useShopState()\n\n  function createFilterableValues(resp) {\n    return resp.edges.map((collection) => {\n      return { label: collection.node.title, id: collection.node.id }\n    })\n  }\n\n  async function grabCollections(cursor = false) {\n    setIsLoadingItems(true)\n\n    var params = {\n      query: \"*\",\n      sortKey: \"TITLE\",\n      first: wp.hooks.applyFilters(\n        \"storefront.collectionsToFetch\",\n        shopwp.general.numPosts\n      ),\n      reverse: false,\n    }\n\n    if (cursor) {\n      params[\"cursor\"] = cursor\n    }\n\n    const [err, resp] = await to(fetchCollections(params, shopState))\n\n    setIsLoadingItems(false)\n\n    var errorMessage = maybeHandleApiError(err, resp, false)\n\n    if (errorMessage) {\n      setError(errorMessage)\n      return\n    }\n\n    if (resp) {\n      setItemsRaw(resp.edges)\n\n      if (resp.pageInfo.hasNextPage) {\n        setHasNextPage(true)\n      } else {\n        setHasNextPage(false)\n      }\n\n      const finalCollections = wp.hooks.applyFilters(\n        \"storefront.availableCollections\",\n        union(existingCollections.concat(createFilterableValues(resp)))\n      )\n\n      setFilterableValues(finalCollections)\n      setExistingCollections(finalCollections)\n    }\n  }\n\n  function onOpen(isOpen) {\n    if (!isOpen) {\n      return\n    }\n\n    if (existingCollections.length) {\n      setFilterableValues(existingCollections)\n      return\n    }\n\n    grabCollections()\n  }\n\n  async function onLoadMore() {\n    var lastItem = itemsRaw[itemsRaw.length - 1]\n\n    if (lastItem && has(lastItem, \"cursor\")) {\n      grabCollections(lastItem.cursor)\n    }\n  }\n\n  useEffect(() => {\n    onOpen(true)\n  }, [])\n\n  const LoadMoreCSS = css`\n    margin: 10px 0 15px 17px;\n    border-radius: 4px;\n  `\n\n  return (\n    <StorefrontFilterOptionsGroup\n      error={error}\n      onOpen={onOpen}\n      openOnLoad={shouldOpen}\n      isLoadingItems={isLoadingItems}\n      groupType=\"collections\"\n      areFilterOptionsEmpty={isEmpty(filterableValues)}\n      noFilterGroupFoundText={settings.noFilterGroupFoundText}\n      heading={settings.collectionsHeading}\n      items={\n        <>\n          <StorefrontFilterOptionsGroupItems\n            filterOptions={filterableValues}\n            isBusy={isLoadingItems}\n            itemType=\"collections\"\n          />\n          {hasNextPage && (\n            <ButtonSecondary\n              settings={settings}\n              isBusy={isLoadingItems}\n              onClick={onLoadMore}\n              extraCSS={LoadMoreCSS}\n            />\n          )}\n        </>\n      }\n    />\n  )\n}\n\nexport default OptionCollections\n"],"names":["onClick","settings","isBusy","extraCSS","secondaryButtonCSS","disabled","css","loadMoreCollectionsBusyText","loadMoreCollectionsText","StorefrontFilterOptionsGroup","wp","lazy","StorefrontFilterOptionsGroupItems","useState","element","useEffect","isLoadingItems","setIsLoadingItems","hasNextPage","setHasNextPage","error","setError","existingCollections","setExistingCollections","itemsRaw","setItemsRaw","filterableValues","setFilterableValues","shouldOpen","shouldOpenOnLoad","shopState","useShopState","createFilterableValues","resp","edges","map","collection","label","node","title","id","grabCollections","cursor","params","query","sortKey","first","applyFilters","shopwp","general","numPosts","reverse","to","fetchCollections","err","errorMessage","maybeHandleApiError","pageInfo","finalCollections","union","concat","onOpen","isOpen","length","lastItem","has","LoadMoreCSS","openOnLoad","groupType","areFilterOptionsEmpty","isEmpty","noFilterGroupFoundText","heading","collectionsHeading","items","filterOptions","itemType"],"sourceRoot":""}