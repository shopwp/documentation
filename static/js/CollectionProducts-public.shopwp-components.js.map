{"version":3,"file":"CollectionProducts-public.shopwp-components.js","mappings":"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","sources":["webpack://shopwpComponents/./src/components/collections/collection/_state/hooks.js","webpack://shopwpComponents/./src/components/collections/collection/products/api.jsx","webpack://shopwpComponents/./src/components/collections/collection/products/index.jsx","webpack://shopwpComponents/./src/components/collections/collection/products/sorting.jsx"],"sourcesContent":["import { CollectionStateContext, CollectionDispatchContext } from \"./context\"\n\nfunction useCollectionState() {\n  const context = wp.element.useContext(CollectionStateContext)\n\n  if (!context) {\n    throw new Error(\n      \"useCollectionState must be used within the CollectionProvider\"\n    )\n  }\n\n  return context\n}\n\nfunction useCollectionDispatch() {\n  const context = wp.element.useContext(CollectionDispatchContext)\n\n  if (!context) {\n    throw new Error(\n      \"useCollectionDispatch must be used within the CollectionProvider\"\n    )\n  }\n\n  return context\n}\n\nexport { useCollectionState, useCollectionDispatch }\n","import {\n  fetchProductsByCollections,\n  queryOptionsNoRefetch,\n  maybeHandleApiError,\n} from \"Api\"\n\nimport { useQuery } from \"react-query\"\nimport isEmpty from \"lodash/isEmpty\"\nimport has from \"lodash/has\"\n\nfunction useGetCollectionProductsQuery(state, dispatch, shopState) {\n  return useQuery(\n    [\"fetchProductsByCollections\", state.productQueryParams],\n    () => {\n      dispatch({ type: \"SET_IS_LOADING\", payload: true })\n\n      return fetchProductsByCollections(state.productQueryParams, shopState)\n    },\n    {\n      enabled: state.isFetchingNew,\n      retry: false,\n      onError: (error) => {\n        dispatch({ type: \"SET_IS_LOADING\", payload: false })\n        dispatch({\n          type: \"SET_IS_FETCHING_NEW\",\n          payload: false,\n        })\n\n        console.error(\"ShopWP Error\", error)\n      },\n      onSuccess: (newItems) => {\n        var error = maybeHandleApiError(false, newItems, dispatch)\n\n        if (error) {\n          dispatch({\n            type: \"SET_PRODUCTS\",\n            payload: [],\n          })\n          return\n        }\n\n        if (\n          !newItems ||\n          isEmpty(newItems) ||\n          (has(newItems, \"edges\") &&\n            (!newItems.edges || !newItems.edges.length))\n        ) {\n          dispatch({\n            type: \"SET_PRODUCTS\",\n            payload: [],\n          })\n        } else {\n          dispatch({\n            type: \"SET_PRODUCTS\",\n            payload: newItems.edges,\n          })\n        }\n\n        dispatch({ type: \"SET_IS_LOADING\", payload: false })\n\n        dispatch({\n          type: \"SET_IS_FETCHING_NEW\",\n          payload: false,\n        })\n      },\n      ...queryOptionsNoRefetch,\n    }\n  )\n}\n\nexport { useGetCollectionProductsQuery }\n","import Products from \"../../../products\"\nimport CollectionSorting from \"./sorting\"\nimport { usePortal } from \"Hooks\"\nimport { useItemsState } from \"../../../items/_state/hooks\"\nimport { useCollectionState, useCollectionDispatch } from \"../_state/hooks\"\nimport { useShopState } from \"../../../shop/_state/hooks\"\nimport { useGetCollectionProductsQuery } from \"./api\"\n\nfunction CollectionProducts() {\n  const collectionState = useCollectionState()\n  const collectionDispatch = useCollectionDispatch()\n  const itemsState = useItemsState()\n  const shopState = useShopState()\n\n  useGetCollectionProductsQuery(collectionState, collectionDispatch, shopState)\n\n  return (\n    <>\n      <Products\n        settings={collectionState.productOptions.settings}\n        element={collectionState.productOptions.element}\n        queryType={collectionState.productOptions.queryType}\n        id={collectionState.productOptions.id}\n        isLoading={collectionState.isLoading}\n        payload={collectionState.products}\n        queryParams={collectionState.productQueryParams}\n        initialFetch={false}\n      />\n\n      {itemsState.settings.sorting\n        ? usePortal(\n            <CollectionSorting settings={itemsState.settings} />,\n            collectionState.productOptions.sortingElement\n          )\n        : null}\n    </>\n  )\n}\n\nexport default CollectionProducts\n","/** @jsx jsx */\nimport { jsx, css } from \"@emotion/react\"\nimport Selects from \"../../../storefront/selects\"\nimport { findDefaultSelectVal, updateQueryParamsWithSort } from \"Utils\"\nimport Loader from \"../../../loader\"\nimport { useCollectionState, useCollectionDispatch } from \"../_state/hooks\"\n\nfunction CollectionSorting({ settings }) {\n  const collectionDispatch = useCollectionDispatch()\n  const collectionState = useCollectionState()\n\n  const CollectionsSortingWrapperCSS = css`\n    width: 100%;\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    margin-bottom: 20px;\n    align-items: baseline;\n\n    #swp-collections-sorting *:hover {\n      cursor: pointer;\n    }\n  `\n\n  const options = [\n    {\n      label: \"Title (A-Z)\",\n      value: \"TITLE\",\n    },\n    {\n      label: \"Title (Z-A)\",\n      value: \"TITLE-REVERSE\",\n    },\n    {\n      label: \"Price (Low to high)\",\n      value: \"PRICE\",\n    },\n    {\n      label: \"Price (high to low)\",\n      value: \"PRICE-REVERSE\",\n    },\n    {\n      label: \"Best Selling\",\n      value: \"BEST_SELLING\",\n    },\n    {\n      label: \"Recently Added\",\n      value: \"CREATED\",\n    },\n    {\n      label: \"Collection default\",\n      value: \"COLLECTION_DEFAULT\",\n    },\n    {\n      label: \"Manual\",\n      value: \"MANUAL\",\n    },\n  ]\n\n  function customOnChange(data) {\n    const params = updateQueryParamsWithSort(data.value)\n\n    const finalNewParams = {\n      ...collectionState.productQueryParams,\n      ...params,\n    }\n\n    collectionDispatch({\n      type: \"SET_PRODUCT_QUERY_PARAMS\",\n      payload: finalNewParams,\n    })\n\n    collectionDispatch({\n      type: \"SET_IS_FETCHING_NEW\",\n      payload: true,\n    })\n  }\n\n  return (\n    <div css={CollectionsSortingWrapperCSS}>\n      {collectionState.isLoading && <Loader color=\"#000\" />}\n      <Selects\n        labelText={wp.i18n.__(\"Sort by:\", \"shopwp\")}\n        selectId=\"swp-collections-sorting\"\n        options={options}\n        customOnChange={customOnChange}\n        defaultValue={findDefaultSelectVal(\n          options,\n          settings.sortBy,\n          settings.reverse\n        )}\n        isLoading={collectionState.isLoading}\n      />\n    </div>\n  )\n}\n\nexport default CollectionSorting\n"],"names":["CollectionStateContext","CollectionDispatchContext","useCollectionState","context","wp","element","useContext","Error","useCollectionDispatch","fetchProductsByCollections","queryOptionsNoRefetch","maybeHandleApiError","useQuery","isEmpty","has","useGetCollectionProductsQuery","state","dispatch","shopState","productQueryParams","type","payload","enabled","isFetchingNew","retry","onError","error","console","onSuccess","newItems","edges","length","Products","CollectionSorting","usePortal","useItemsState","useShopState","CollectionProducts","collectionState","collectionDispatch","itemsState","productOptions","settings","queryType","id","isLoading","products","sorting","sortingElement","jsx","css","Selects","findDefaultSelectVal","updateQueryParamsWithSort","Loader","CollectionsSortingWrapperCSS","options","label","value","customOnChange","data","params","finalNewParams","i18n","__","sortBy","reverse"],"sourceRoot":""}